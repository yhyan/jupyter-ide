(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[5977],{34406:e=>{var t=e.exports={};var s;var n;function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){s=setTimeout}else{s=i}}catch(e){s=i}try{if(typeof clearTimeout==="function"){n=clearTimeout}else{n=r}}catch(e){n=r}})();function o(e){if(s===setTimeout){return setTimeout(e,0)}if((s===i||!s)&&setTimeout){s=setTimeout;return setTimeout(e,0)}try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}function a(e){if(n===clearTimeout){return clearTimeout(e)}if((n===r||!n)&&clearTimeout){n=clearTimeout;return clearTimeout(e)}try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}var c=[];var l=false;var h;var u=-1;function d(){if(!l||!h){return}l=false;if(h.length){c=h.concat(c)}else{u=-1}if(c.length){_()}}function _(){if(l){return}var e=o(d);l=true;var t=c.length;while(t){h=c;c=[];while(++u<t){if(h){h[u].run()}}u=-1;t=c.length}h=null;l=false;a(e)}t.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var s=1;s<arguments.length;s++){t[s-1]=arguments[s]}}c.push(new g(e,t));if(c.length===1&&!l){o(_)}};function g(e,t){this.fun=e;this.array=t}g.prototype.run=function(){this.fun.apply(null,this.array)};t.title="browser";t.browser=true;t.env={};t.argv=[];t.version="";t.versions={};function p(){}t.on=p;t.addListener=p;t.once=p;t.off=p;t.removeListener=p;t.removeAllListeners=p;t.emit=p;t.prependListener=p;t.prependOnceListener=p;t.listeners=function(e){return[]};t.binding=function(e){throw new Error("process.binding is not supported")};t.cwd=function(){return"/"};t.chdir=function(e){throw new Error("process.chdir is not supported")};t.umask=function(){return 0}},93773:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseManager=void 0;const n=s(75138);const i=s(51360);class r{constructor(e){var t;this._isDisposed=false;this._disposed=new n.Signal(this);this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:i.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}dispose(){if(this.isDisposed){return}this._disposed.emit(undefined);n.Signal.clearData(this)}}t.BaseManager=r},77522:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BuildManager=void 0;const n=s(83875);const i=s(51360);const r="api/build";class o{constructor(e={}){var t;this._url="";this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:i.ServerConnection.makeSettings();const{baseUrl:s,appUrl:o}=this.serverSettings;this._url=n.URLExt.join(s,o,r)}get isAvailable(){return n.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return n.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){const{_url:e,serverSettings:t}=this;const s=i.ServerConnection.makeRequest(e,{},t);return s.then((e=>{if(e.status!==200){throw new i.ServerConnection.ResponseError(e)}return e.json()})).then((e=>{if(typeof e.status!=="string"){throw new Error("Invalid data")}if(typeof e.message!=="string"){throw new Error("Invalid data")}return e}))}build(){const{_url:e,serverSettings:t}=this;const s={method:"POST"};const n=i.ServerConnection.makeRequest(e,s,t);return n.then((e=>{if(e.status===400){throw new i.ServerConnection.ResponseError(e,"Build aborted")}if(e.status!==200){const t=`Build failed with ${e.status}.\n\n        If you are experiencing the build failure after installing an extension (or trying to include previously installed extension after updating JupyterLab) please check the extension repository for new installation instructions as many extensions migrated to the prebuilt extensions system which no longer requires rebuilding JupyterLab (but uses a different installation procedure, typically involving a package manager such as 'pip' or 'conda').\n\n        If you specifically intended to install a source extension, please run 'jupyter lab build' on the server for full output.`;throw new i.ServerConnection.ResponseError(e,t)}}))}cancel(){const{_url:e,serverSettings:t}=this;const s={method:"DELETE"};const n=i.ServerConnection.makeRequest(e,s,t);return n.then((e=>{if(e.status!==204){throw new i.ServerConnection.ResponseError(e)}}))}}t.BuildManager=o},35450:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConfigWithDefaults=t.ConfigSection=void 0;const n=s(83875);const i=s(75977);const r="api/config";var o;(function(e){function t(e){const t=new a(e);return t.load().then((()=>t))}e.create=t})(o=t.ConfigSection||(t.ConfigSection={}));class a{constructor(e){var t;this._url="unknown";const s=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:i.ServerConnection.makeSettings();this._url=n.URLExt.join(s.baseUrl,r,encodeURIComponent(e.name))}get data(){return this._data}async load(){const e=await i.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200){const t=await i.ServerConnection.ResponseError.create(e);throw t}this._data=await e.json()}async update(e){this._data=Object.assign(Object.assign({},this._data),e);const t={method:"PATCH",body:JSON.stringify(e)};const s=await i.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(s.status!==200){const e=await i.ServerConnection.ResponseError.create(s);throw e}this._data=await s.json();return this._data}}class c{constructor(e){var t,s;this._className="";this._section=e.section;this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{};this._className=(s=e.className)!==null&&s!==void 0?s:""}get(e){const t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){const s={};s[e]=t;if(this._className){const e={};e[this._className]=s;return this._section.update(e)}else{return this._section.update(s)}}_classData(){const e=this._section.data;if(this._className&&this._className in e){return e[this._className]}return e}}t.ConfigWithDefaults=c},64994:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.Drive=t.ContentsManager=t.Contents=void 0;const o=s(83875);const a=s(62867);const c=s(75138);const l=s(75977);const h=r(s(16923));const u="api/contents";const d="files";var _;(function(e){function t(e){h.validateContentsModel(e)}e.validateContentsModel=t;function s(e){h.validateCheckpointModel(e)}e.validateCheckpointModel=s})(_=t.Contents||(t.Contents={}));class g{constructor(e={}){var t,s;this._isDisposed=false;this._additionalDrives=new Map;this._fileChanged=new c.Signal(this);const n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:l.ServerConnection.makeSettings();this._defaultDrive=(s=e.defaultDrive)!==null&&s!==void 0?s:new p({serverSettings:n});this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){if(this.isDisposed){return}this._isDisposed=true;c.Signal.clearData(this)}addDrive(e){this._additionalDrives.set(e.name,e);e.fileChanged.connect(this._onFileChanged,this)}getModelDBFactory(e){var t;const[s]=this._driveForPath(e);return(t=s===null||s===void 0?void 0:s.modelDBFactory)!==null&&t!==void 0?t:null}localPath(e){const t=e.split("/");const s=t[0].split(":");if(s.length===1||!this._additionalDrives.has(s[0])){return o.PathExt.removeSlash(e)}return o.PathExt.join(s.slice(1).join(":"),...t.slice(1))}normalize(e){const t=e.split(":");if(t.length===1){return o.PathExt.normalize(e)}return`${t[0]}:${o.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){const s=this.driveName(e);const n=this.localPath(e);const i=o.PathExt.resolve("/",n,t);return s?`${s}:${i}`:i}driveName(e){const t=e.split("/");const s=t[0].split(":");if(s.length===1){return""}if(this._additionalDrives.has(s[0])){return s[0]}return""}get(e,t){const[s,n]=this._driveForPath(e);return s.get(n,t).then((e=>{const t=[];if(e.type==="directory"&&e.content){a.each(e.content,(e=>{t.push(Object.assign(Object.assign({},e),{path:this._toGlobalPath(s,e.path)}))}));return Object.assign(Object.assign({},e),{path:this._toGlobalPath(s,n),content:t})}else{return Object.assign(Object.assign({},e),{path:this._toGlobalPath(s,n)})}}))}getDownloadUrl(e){const[t,s]=this._driveForPath(e);return t.getDownloadUrl(s)}newUntitled(e={}){if(e.path){const t=this.normalize(e.path);const[s,n]=this._driveForPath(t);return s.newUntitled(Object.assign(Object.assign({},e),{path:n})).then((e=>Object.assign(Object.assign({},e),{path:o.PathExt.join(t,e.name)})))}else{return this._defaultDrive.newUntitled(e)}}delete(e){const[t,s]=this._driveForPath(e);return t.delete(s)}rename(e,t){const[s,n]=this._driveForPath(e);const[i,r]=this._driveForPath(t);if(s!==i){throw Error("ContentsManager: renaming files must occur within a Drive")}return s.rename(n,r).then((e=>Object.assign(Object.assign({},e),{path:this._toGlobalPath(s,r)})))}save(e,t={}){const s=this.normalize(e);const[n,i]=this._driveForPath(e);return n.save(i,Object.assign(Object.assign({},t),{path:i})).then((e=>Object.assign(Object.assign({},e),{path:s})))}copy(e,t){const[s,n]=this._driveForPath(e);const[i,r]=this._driveForPath(t);if(s===i){return s.copy(n,r).then((e=>Object.assign(Object.assign({},e),{path:this._toGlobalPath(s,e.path)})))}else{throw Error("Copying files between drives is not currently implemented")}}createCheckpoint(e){const[t,s]=this._driveForPath(e);return t.createCheckpoint(s)}listCheckpoints(e){const[t,s]=this._driveForPath(e);return t.listCheckpoints(s)}restoreCheckpoint(e,t){const[s,n]=this._driveForPath(e);return s.restoreCheckpoint(n,t)}deleteCheckpoint(e,t){const[s,n]=this._driveForPath(e);return s.deleteCheckpoint(n,t)}_toGlobalPath(e,t){if(e===this._defaultDrive){return o.PathExt.removeSlash(t)}else{return`${e.name}:${o.PathExt.removeSlash(t)}`}}_driveForPath(e){const t=this.driveName(e);const s=this.localPath(e);if(t){return[this._additionalDrives.get(t),s]}else{return[this._defaultDrive,s]}}_onFileChanged(e,t){var s,n;if(e===this._defaultDrive){this._fileChanged.emit(t)}else{let i=null;let r=null;if((s=t.newValue)===null||s===void 0?void 0:s.path){i=Object.assign(Object.assign({},t.newValue),{path:this._toGlobalPath(e,t.newValue.path)})}if((n=t.oldValue)===null||n===void 0?void 0:n.path){r=Object.assign(Object.assign({},t.oldValue),{path:this._toGlobalPath(e,t.oldValue.path)})}this._fileChanged.emit({type:t.type,newValue:i,oldValue:r})}}}t.ContentsManager=g;class p{constructor(e={}){var t,s,n;this._isDisposed=false;this._fileChanged=new c.Signal(this);this.name=(t=e.name)!==null&&t!==void 0?t:"Default";this._apiEndpoint=(s=e.apiEndpoint)!==null&&s!==void 0?s:u;this.serverSettings=(n=e.serverSettings)!==null&&n!==void 0?n:l.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){if(this.isDisposed){return}this._isDisposed=true;c.Signal.clearData(this)}async get(e,t){let s=this._getUrl(e);if(t){if(t.type==="notebook"){delete t["format"]}const e=t.content?"1":"0";const n=Object.assign(Object.assign({},t),{content:e});s+=o.URLExt.objectToQueryString(n)}const n=this.serverSettings;const i=await l.ServerConnection.makeRequest(s,{},n);if(i.status!==200){const e=await l.ServerConnection.ResponseError.create(i);throw e}const r=await i.json();h.validateContentsModel(r);return r}getDownloadUrl(e){const t=this.serverSettings.baseUrl;let s=o.URLExt.join(t,d,o.URLExt.encodeParts(e));const n=document.cookie.match("\\b_xsrf=([^;]*)\\b");if(n){const e=new URL(s);e.searchParams.append("_xsrf",n[1]);s=e.toString()}return Promise.resolve(s)}async newUntitled(e={}){var t;let s="{}";if(e){if(e.ext){e.ext=f.normalizeExtension(e.ext)}s=JSON.stringify(e)}const n=this.serverSettings;const i=this._getUrl((t=e.path)!==null&&t!==void 0?t:"");const r={method:"POST",body:s};const o=await l.ServerConnection.makeRequest(i,r,n);if(o.status!==201){const e=await l.ServerConnection.ResponseError.create(o);throw e}const a=await o.json();h.validateContentsModel(a);this._fileChanged.emit({type:"new",oldValue:null,newValue:a});return a}async delete(e){const t=this._getUrl(e);const s=this.serverSettings;const n={method:"DELETE"};const i=await l.ServerConnection.makeRequest(t,n,s);if(i.status!==204){const e=await l.ServerConnection.ResponseError.create(i);throw e}this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){const s=this.serverSettings;const n=this._getUrl(e);const i={method:"PATCH",body:JSON.stringify({path:t})};const r=await l.ServerConnection.makeRequest(n,i,s);if(r.status!==200){const e=await l.ServerConnection.ResponseError.create(r);throw e}const o=await r.json();h.validateContentsModel(o);this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:o});return o}async save(e,t={}){const s=this.serverSettings;const n=this._getUrl(e);const i={method:"PUT",body:JSON.stringify(t)};const r=await l.ServerConnection.makeRequest(n,i,s);if(r.status!==200&&r.status!==201){const e=await l.ServerConnection.ResponseError.create(r);throw e}const o=await r.json();h.validateContentsModel(o);this._fileChanged.emit({type:"save",oldValue:null,newValue:o});return o}async copy(e,t){const s=this.serverSettings;const n=this._getUrl(t);const i={method:"POST",body:JSON.stringify({copy_from:e})};const r=await l.ServerConnection.makeRequest(n,i,s);if(r.status!==201){const e=await l.ServerConnection.ResponseError.create(r);throw e}const o=await r.json();h.validateContentsModel(o);this._fileChanged.emit({type:"new",oldValue:null,newValue:o});return o}async createCheckpoint(e){const t=this._getUrl(e,"checkpoints");const s={method:"POST"};const n=await l.ServerConnection.makeRequest(t,s,this.serverSettings);if(n.status!==201){const e=await l.ServerConnection.ResponseError.create(n);throw e}const i=await n.json();h.validateCheckpointModel(i);return i}async listCheckpoints(e){const t=this._getUrl(e,"checkpoints");const s=await l.ServerConnection.makeRequest(t,{},this.serverSettings);if(s.status!==200){const e=await l.ServerConnection.ResponseError.create(s);throw e}const n=await s.json();if(!Array.isArray(n)){throw new Error("Invalid Checkpoint list")}for(let i=0;i<n.length;i++){h.validateCheckpointModel(n[i])}return n}async restoreCheckpoint(e,t){const s=this._getUrl(e,"checkpoints",t);const n={method:"POST"};const i=await l.ServerConnection.makeRequest(s,n,this.serverSettings);if(i.status!==204){const e=await l.ServerConnection.ResponseError.create(i);throw e}}async deleteCheckpoint(e,t){const s=this._getUrl(e,"checkpoints",t);const n={method:"DELETE"};const i=await l.ServerConnection.makeRequest(s,n,this.serverSettings);if(i.status!==204){const e=await l.ServerConnection.ResponseError.create(i);throw e}}_getUrl(...e){const t=e.map((e=>o.URLExt.encodeParts(e)));const s=this.serverSettings.baseUrl;return o.URLExt.join(s,this._apiEndpoint,...t)}}t.Drive=p;var f;(function(e){function t(e){if(e.length>0&&e.indexOf(".")!==0){e=`.${e}`}return e}e.normalizeExtension=t})(f||(f={}))},16923:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateCheckpointModel=t.validateContentsModel=void 0;const n=s(79612);function i(e){n.validateProperty(e,"name","string");n.validateProperty(e,"path","string");n.validateProperty(e,"type","string");n.validateProperty(e,"created","string");n.validateProperty(e,"last_modified","string");n.validateProperty(e,"mimetype","object");n.validateProperty(e,"content","object");n.validateProperty(e,"format","object")}t.validateContentsModel=i;function r(e){n.validateProperty(e,"id","string");n.validateProperty(e,"last_modified","string")}t.validateCheckpointModel=r},75977:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))n(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});i(s(35450),t);i(s(64994),t);i(s(10290),t);i(s(2384),t);i(s(85091),t);i(s(51360),t);i(s(47626),t);i(s(32385),t);i(s(97228),t);i(s(73064),t);i(s(98869),t)},25261:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.CommHandler=void 0;const o=s(76487);const a=r(s(24770));class c extends o.DisposableDelegate{constructor(e,t,s,n){super(n);this._target="";this._id="";this._id=t;this._target=e;this._kernel=s}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,s=[]){if(this.isDisposed||this._kernel.isDisposed){throw new Error("Cannot open")}const n=a.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!==null&&e!==void 0?e:{}},metadata:t,buffers:s});return this._kernel.sendShellMessage(n,false,true)}send(e,t,s=[],n=true){if(this.isDisposed||this._kernel.isDisposed){throw new Error("Cannot send")}const i=a.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:s});return this._kernel.sendShellMessage(i,false,n)}close(e,t,s=[]){if(this.isDisposed||this._kernel.isDisposed){throw new Error("Cannot close")}const n=a.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!==null&&e!==void 0?e:{}},metadata:t,buffers:s});const i=this._kernel.sendShellMessage(n,false,true);const r=this._onClose;if(r){const n=a.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!==null&&e!==void 0?e:{}},metadata:t,buffers:s});void r(n)}this.dispose();return i}}t.CommHandler=c},97836:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.KernelConnection=void 0;const o=s(83875);const a=s(9727);const c=s(75138);const l=s(75977);const h=s(25261);const u=r(s(24770));const d=s(24612);const _=r(s(49211));const g=r(s(24982));const p=s(2384);const f=r(s(43591));const m=3e3;const v="_RESTARTING_";const w="";class S{constructor(e){var t,s,n,i;this._createSocket=()=>{this._errorIfDisposed();this._clearSocket();this._updateConnectionStatus("connecting");const e=this.serverSettings;const t=o.URLExt.join(e.wsUrl,f.KERNEL_SERVICE_URL,encodeURIComponent(this._id));const s=t.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1");console.debug(`Starting WebSocket: ${s}`);let n=o.URLExt.join(t,"channels?session_id="+encodeURIComponent(this._clientId));const i=e.token;if(e.appendToken&&i!==""){n=n+`&token=${encodeURIComponent(i)}`}this._ws=new e.WebSocket(n);this._ws.binaryType="arraybuffer";this._ws.onmessage=this._onWSMessage;this._ws.onopen=this._onWSOpen;this._ws.onclose=this._onWSClose;this._ws.onerror=this._onWSClose};this._onWSOpen=e=>{this._updateConnectionStatus("connected")};this._onWSMessage=e=>{let t;try{t=_.deserialize(e.data);g.validateMessage(t)}catch(s){s.message=`Kernel message validation error: ${s.message}`;throw s}this._kernelSession=t.header.session;this._msgChain=this._msgChain.then((()=>this._handleMessage(t))).catch((e=>{if(e.message.startsWith("Canceled future for ")){console.error(e)}}));this._anyMessage.emit({msg:t,direction:"recv"})};this._onWSClose=e=>{if(!this.isDisposed){this._reconnect()}};this._id="";this._name="";this._status="unknown";this._connectionStatus="connecting";this._kernelSession="";this._isDisposed=false;this._ws=null;this._username="";this._reconnectLimit=7;this._reconnectAttempt=0;this._reconnectTimeout=null;this._futures=new Map;this._comms=new Map;this._targetRegistry=Object.create(null);this._info=new a.PromiseDelegate;this._pendingMessages=[];this._statusChanged=new c.Signal(this);this._connectionStatusChanged=new c.Signal(this);this._disposed=new c.Signal(this);this._iopubMessage=new c.Signal(this);this._anyMessage=new c.Signal(this);this._pendingInput=new c.Signal(this);this._unhandledMessage=new c.Signal(this);this._displayIdToParentIds=new Map;this._msgIdToDisplayIds=new Map;this._msgChain=Promise.resolve();this._hasPendingInput=false;this._noOp=()=>{};this._name=e.model.name;this._id=e.model.id;this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:l.ServerConnection.makeSettings();this._clientId=(s=e.clientId)!==null&&s!==void 0?s:a.UUID.uuid4();this._username=(n=e.username)!==null&&n!==void 0?n:"";this.handleComms=(i=e.handleComms)!==null&&i!==void 0?i:true;this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return{id:this.id,name:this.name}}get anyMessage(){return this._anyMessage}get pendingInput(){return this._pendingInput}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){if(this._specPromise){return this._specPromise}this._specPromise=p.KernelSpecAPI.getSpecs(this.serverSettings).then((e=>e.kernelspecs[this._name]));return this._specPromise}clone(e={}){return new S(Object.assign({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:false},e))}dispose(){if(this.isDisposed){return}this._isDisposed=true;this._disposed.emit();this._updateConnectionStatus("disconnected");this._clearKernelState();this._pendingMessages=[];this._clearSocket();c.Signal.clearData(this)}sendShellMessage(e,t=false,s=true){return this._sendKernelShellControl(d.KernelShellFutureHandler,e,t,s)}sendControlMessage(e,t=false,s=true){return this._sendKernelShellControl(d.KernelControlFutureHandler,e,t,s)}_sendKernelShellControl(e,t,s=false,n=true){this._sendMessage(t);this._anyMessage.emit({msg:t,direction:"send"});const i=new e((()=>{const e=t.header.msg_id;this._futures.delete(e);const s=this._msgIdToDisplayIds.get(e);if(!s){return}s.forEach((t=>{const s=this._displayIdToParentIds.get(t);if(s){const n=s.indexOf(e);if(n===-1){return}if(s.length===1){this._displayIdToParentIds.delete(t)}else{s.splice(n,1);this._displayIdToParentIds.set(t,s)}}}));this._msgIdToDisplayIds.delete(e)}),t,s,n,this);this._futures.set(t.header.msg_id,i);return i}_sendMessage(e,t=true){if(this.status==="dead"){throw new Error("Kernel is dead")}if((this._kernelSession===w||this._kernelSession===v)&&u.isInfoRequestMsg(e)){if(this.connectionStatus==="connected"){this._ws.send(_.serialize(e));return}else{throw new Error("Could not send message: status is not connected")}}if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==v){this._ws.send(_.serialize(e))}else if(t){this._pendingMessages.push(e)}else{throw new Error("Could not send message")}}async interrupt(){this.hasPendingInput=false;if(this.status==="dead"){throw new Error("Kernel is dead")}return f.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead"){throw new Error("Kernel is dead")}this._updateStatus("restarting");this._clearKernelState();this._kernelSession=v;await f.restartKernel(this.id,this.serverSettings);await this.reconnect();this.hasPendingInput=false}reconnect(){this._errorIfDisposed();const e=new a.PromiseDelegate;const t=(s,n)=>{if(n==="connected"){e.resolve();this.connectionStatusChanged.disconnect(t,this)}else if(n==="disconnected"){e.reject(new Error("Kernel connection disconnected"));this.connectionStatusChanged.disconnect(t,this)}};this.connectionStatusChanged.connect(t,this);this._reconnectAttempt=0;this._reconnect();return e.promise}async shutdown(){if(this.status!=="dead"){await f.shutdownKernel(this.id,this.serverSettings)}this.handleShutdown()}handleShutdown(){this._updateStatus("dead");this.dispose()}async requestKernelInfo(){const e=u.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}});let t;try{t=await y.handleShellMessage(this,e)}catch(s){if(this.isDisposed){return}else{throw s}}this._errorIfDisposed();if(!t){return}if(t.content.status===undefined){t.content.status="ok"}if(t.content.status!=="ok"){this._info.reject("Kernel info reply errored");return t}this._info.resolve(t.content);this._kernelSession=t.header.session;return t}requestComplete(e){const t=u.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return y.handleShellMessage(this,t)}requestInspect(e){const t=u.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return y.handleShellMessage(this,t)}requestHistory(e){const t=u.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return y.handleShellMessage(this,t)}requestExecute(e,t=true,s){const n={silent:false,store_history:true,user_expressions:{},allow_stdin:true,stop_on_error:false};const i=u.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:Object.assign(Object.assign({},n),e),metadata:s});return this.sendShellMessage(i,true,t)}requestDebug(e,t=true){const s=u.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(s,true,t)}requestIsComplete(e){const t=u.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return y.handleShellMessage(this,t)}requestCommInfo(e){const t=u.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return y.handleShellMessage(this,t)}sendInputReply(e){const t=u.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});this._sendMessage(t);this._anyMessage.emit({msg:t,direction:"send"});this.hasPendingInput=false}createComm(e,t=a.UUID.uuid4()){if(!this.handleComms){throw new Error("Comms are disabled on this kernel connection")}if(this._comms.has(t)){throw new Error("Comm is already created")}const s=new h.CommHandler(e,t,this,(()=>{this._unregisterComm(t)}));this._comms.set(t,s);return s}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){if(!this.handleComms){return}this._targetRegistry[e]=t}removeCommTarget(e,t){if(!this.handleComms){return}if(!this.isDisposed&&this._targetRegistry[e]===t){delete this._targetRegistry[e]}}registerMessageHook(e,t){var s;const n=(s=this._futures)===null||s===void 0?void 0:s.get(e);if(n){n.registerMessageHook(t)}}removeMessageHook(e,t){var s;const n=(s=this._futures)===null||s===void 0?void 0:s.get(e);if(n){n.removeMessageHook(t)}}removeInputGuard(){this.hasPendingInput=false}async _handleDisplayId(e,t){var s,n;const i=t.parent_header.msg_id;let r=this._displayIdToParentIds.get(e);if(r){const e={header:a.JSONExt.deepCopy(t.header),parent_header:a.JSONExt.deepCopy(t.parent_header),metadata:a.JSONExt.deepCopy(t.metadata),content:a.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};e.header.msg_type="update_display_data";await Promise.all(r.map((async t=>{const s=this._futures&&this._futures.get(t);if(s){await s.handleMsg(e)}})))}if(t.header.msg_type==="update_display_data"){return true}r=(s=this._displayIdToParentIds.get(e))!==null&&s!==void 0?s:[];if(r.indexOf(i)===-1){r.push(i)}this._displayIdToParentIds.set(e,r);const o=(n=this._msgIdToDisplayIds.get(i))!==null&&n!==void 0?n:[];if(o.indexOf(i)===-1){o.push(i)}this._msgIdToDisplayIds.set(i,o);return false}_clearSocket(){if(this._ws!==null){this._ws.onopen=this._noOp;this._ws.onclose=this._noOp;this._ws.onerror=this._noOp;this._ws.onmessage=this._noOp;this._ws.close();this._ws=null}}_updateStatus(e){if(this._status===e||this._status==="dead"){return}this._status=e;y.logKernelStatus(this);this._statusChanged.emit(e);if(e==="dead"){this.dispose()}}_sendPending(){while(this.connectionStatus==="connected"&&this._kernelSession!==v&&this._pendingMessages.length>0){this._sendMessage(this._pendingMessages[0],false);this._pendingMessages.shift()}}_clearKernelState(){this._kernelSession="";this._pendingMessages=[];this._futures.forEach((e=>{e.dispose()}));this._comms.forEach((e=>{e.dispose()}));this._msgChain=Promise.resolve();this._futures=new Map;this._comms=new Map;this._displayIdToParentIds.clear();this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){this._errorIfDisposed();if(e.header.session!==this._kernelSession){throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}}async _handleCommOpen(e){this._assertCurrentMessage(e);const t=e.content;const s=new h.CommHandler(t.target_name,t.comm_id,this,(()=>{this._unregisterComm(t.comm_id)}));this._comms.set(t.comm_id,s);try{const n=await y.loadObject(t.target_name,t.target_module,this._targetRegistry);await n(s,e)}catch(n){s.close();console.error("Exception opening new comm");throw n}}async _handleCommClose(e){this._assertCurrentMessage(e);const t=e.content;const s=this._comms.get(t.comm_id);if(!s){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(s.commId);const n=s.onClose;if(n){await n(e)}s.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);const t=e.content;const s=this._comms.get(t.comm_id);if(!s){return}const n=s.onMsg;if(n){await n(e)}}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus===e){return}this._connectionStatus=e;if(e!=="connecting"){this._reconnectAttempt=0;clearTimeout(this._reconnectTimeout)}if(this.status!=="dead"){if(e==="connected"){let e=this._kernelSession===v;let t=this.requestKernelInfo();let s=false;let n=()=>{if(s){return}s=true;if(e&&this._kernelSession===v){this._kernelSession=""}clearTimeout(i);if(this._pendingMessages.length>0){this._sendPending()}};void t.then(n);let i=setTimeout(n,m)}else{this._updateStatus("unknown")}}this._connectionStatusChanged.emit(e)}async _handleMessage(e){var t,s;let n=false;if(e.parent_header&&e.channel==="iopub"&&(u.isDisplayDataMsg(e)||u.isUpdateDisplayDataMsg(e)||u.isExecuteResultMsg(e))){const s=(t=e.content.transient)!==null&&t!==void 0?t:{};const i=s["display_id"];if(i){n=await this._handleDisplayId(i,e);this._assertCurrentMessage(e)}}if(!n&&e.parent_header){const t=e.parent_header;const n=(s=this._futures)===null||s===void 0?void 0:s.get(t.msg_id);if(n){await n.handleMsg(e);this._assertCurrentMessage(e)}else{const s=t.session===this.clientId;if(e.channel!=="iopub"&&s){this._unhandledMessage.emit(e)}}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{const t=e.content.execution_state;if(t==="restarting"){void Promise.resolve().then((async()=>{this._updateStatus("autorestarting");this._clearKernelState();await this.reconnect()}))}this._updateStatus(t);break}case"comm_open":if(this.handleComms){await this._handleCommOpen(e)}break;case"comm_msg":if(this.handleComms){await this._handleCommMsg(e)}break;case"comm_close":if(this.handleComms){await this._handleCommClose(e)}break;default:break}if(!this.isDisposed){this._assertCurrentMessage(e);this._iopubMessage.emit(e)}}}_reconnect(){this._errorIfDisposed();clearTimeout(this._reconnectTimeout);if(this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");const e=y.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`);this._reconnectTimeout=setTimeout(this._createSocket,e);this._reconnectAttempt+=1}else{this._updateConnectionStatus("disconnected")}this._clearSocket()}_errorIfDisposed(){if(this.isDisposed){throw new Error("Kernel connection is disposed")}}get hasPendingInput(){return this._hasPendingInput}set hasPendingInput(e){this._hasPendingInput=e;this._pendingInput.emit(e)}}t.KernelConnection=S;var y;(function(e){function t(e){switch(e.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${e.status} (${e.id})`);break}}e.logKernelStatus=t;async function s(e,t){const s=e.sendShellMessage(t,true);return s.done}e.handleShellMessage=s;function n(e,t,s){return new Promise(((n,i)=>{if(t){if(typeof requirejs==="undefined"){throw new Error("requirejs not found")}requirejs([t],(s=>{if(s[e]===void 0){const s=`Object '${e}' not found in module '${t}'`;i(new Error(s))}else{n(s[e])}}),i)}else{if(s===null||s===void 0?void 0:s[e]){n(s[e])}else{i(new Error(`Object '${e}' not found in registry`))}}}))}e.loadObject=n;function i(e,t){e=Math.ceil(e);t=Math.floor(t);return Math.floor(Math.random()*(t-e+1))+e}e.getRandomIntInclusive=i})(y||(y={}))},24612:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.KernelShellFutureHandler=t.KernelControlFutureHandler=t.KernelFutureHandler=void 0;const o=s(9727);const a=s(76487);const c=r(s(24770));class l extends a.DisposableDelegate{constructor(e,t,s,n,i){super(e);this._status=0;this._stdin=d.noOp;this._iopub=d.noOp;this._reply=d.noOp;this._done=new o.PromiseDelegate;this._hooks=new d.HookList;this._disposeOnDone=true;this._msg=t;if(!s){this._setFlag(d.KernelFutureFlag.GotReply)}this._disposeOnDone=n;this._kernel=i}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed){throw new Error("Kernel future is disposed")}this._hooks.add(e)}removeMessageHook(e){if(this.isDisposed){return}this._hooks.remove(e)}sendInputReply(e){this._kernel.sendInputReply(e)}dispose(){this._stdin=d.noOp;this._iopub=d.noOp;this._reply=d.noOp;this._hooks=null;if(!this._testFlag(d.KernelFutureFlag.IsDone)){this._done.promise.catch((()=>{}));this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))}super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":if(e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id){await this._handleReply(e)}break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){const t=this._reply;if(t){await t(e)}this._replyMsg=e;this._setFlag(d.KernelFutureFlag.GotReply);if(this._testFlag(d.KernelFutureFlag.GotIdle)){this._handleDone()}}async _handleStdin(e){this._kernel.hasPendingInput=true;const t=this._stdin;if(t){await t(e)}}async _handleIOPub(e){const t=await this._hooks.process(e);const s=this._iopub;if(t&&s){await s(e)}if(c.isStatusMsg(e)&&e.content.execution_state==="idle"){this._setFlag(d.KernelFutureFlag.GotIdle);if(this._testFlag(d.KernelFutureFlag.GotReply)){this._handleDone()}}}_handleDone(){if(this._testFlag(d.KernelFutureFlag.IsDone)){return}this._setFlag(d.KernelFutureFlag.IsDone);this._done.resolve(this._replyMsg);if(this._disposeOnDone){this.dispose()}}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}}t.KernelFutureHandler=l;class h extends l{}t.KernelControlFutureHandler=h;class u extends l{}t.KernelShellFutureHandler=u;var d;(function(e){e.noOp=()=>{};const t=(()=>{const e=typeof requestAnimationFrame==="function";return e?requestAnimationFrame:setImmediate})();class s{constructor(){this._hooks=[]}add(e){this.remove(e);this._hooks.push(e)}remove(e){const t=this._hooks.indexOf(e);if(t>=0){this._hooks[t]=null;this._scheduleCompact()}}async process(e){await this._processing;const t=new o.PromiseDelegate;this._processing=t.promise;let s;for(let i=this._hooks.length-1;i>=0;i--){const r=this._hooks[i];if(r===null){continue}try{s=await r(e)}catch(n){s=true;console.error(n)}if(s===false){t.resolve(undefined);return false}}t.resolve(undefined);return true}_scheduleCompact(){if(!this._compactScheduled){this._compactScheduled=true;t((()=>{this._processing=this._processing.then((()=>{this._compactScheduled=false;this._compact()}))}))}}_compact(){let e=0;for(let t=0,s=this._hooks.length;t<s;t++){const s=this._hooks[t];if(this._hooks[t]===null){e++}else{this._hooks[t-e]=s}}this._hooks.length-=e}}e.HookList=s;let n;(function(e){e[e["GotReply"]=1]="GotReply";e[e["GotIdle"]=2]="GotIdle";e[e["IsDone"]=4]="IsDone";e[e["DisposeOnDone"]=8]="DisposeOnDone"})(n=e.KernelFutureFlag||(e.KernelFutureFlag={}))})(d||(d={}))},10290:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))n(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});t.KernelAPI=t.KernelMessage=t.Kernel=void 0;const a=r(s(59790));t.Kernel=a;const c=r(s(24770));t.KernelMessage=c;const l=r(s(43591));t.KernelAPI=l;o(s(513),t)},59790:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true})},513:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.KernelManager=void 0;const n=s(62867);const i=s(87598);const r=s(75138);const o=s(75977);const a=s(93773);const c=s(43591);const l=s(97836);class h extends a.BaseManager{constructor(e={}){var t;super(e);this._isReady=false;this._kernelConnections=new Set;this._models=new Map;this._runningChanged=new r.Signal(this);this._connectionFailure=new r.Signal(this);this._pollModels=new i.Poll({auto:false,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:true,max:300*1e3},name:`@jupyterlab/services:KernelManager#models`,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"});this._ready=(async()=>{await this._pollModels.start();await this._pollModels.tick;this._isReady=true})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){if(this.isDisposed){return}this._models.clear();this._kernelConnections.forEach((e=>e.dispose()));this._pollModels.dispose();super.dispose()}connectTo(e){var t;const{id:s}=e.model;let n=(t=e.handleComms)!==null&&t!==void 0?t:true;if(e.handleComms===undefined){for(const e of this._kernelConnections){if(e.id===s&&e.handleComms){n=false;break}}}const i=new l.KernelConnection(Object.assign(Object.assign({handleComms:n},e),{serverSettings:this.serverSettings}));this._onStarted(i);if(!this._models.has(s)){void this.refreshRunning().catch((()=>{}))}return i}running(){return n.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh();await this._pollModels.tick}async startNew(e={},t={}){const s=await c.startNew(e,this.serverSettings);return this.connectTo(Object.assign(Object.assign({},t),{model:s}))}async shutdown(e){await c.shutdownKernel(e,this.serverSettings);await this.refreshRunning()}async shutdownAll(){await this.refreshRunning();await Promise.all([...this._models.keys()].map((e=>c.shutdownKernel(e,this.serverSettings))));await this.refreshRunning()}async findById(e){if(this._models.has(e)){return this._models.get(e)}await this.refreshRunning();return this._models.get(e)}async requestRunning(){var e,t;let s;try{s=await c.listRunning(this.serverSettings)}catch(i){if(i instanceof o.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424){this._connectionFailure.emit(i)}throw i}if(this.isDisposed){return}if(this._models.size===s.length&&n.every(s,(e=>{const t=this._models.get(e.id);if(!t){return false}return t.name===e.name}))){return}this._models=new Map(s.map((e=>[e.id,e])));this._kernelConnections.forEach((e=>{if(!this._models.has(e.id)){e.handleShutdown()}}));this._runningChanged.emit(s)}_onStarted(e){this._kernelConnections.add(e);e.statusChanged.connect(this._onStatusChanged,this);e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e);void this.refreshRunning().catch((()=>{}))}_onStatusChanged(e,t){if(t==="dead"){void this.refreshRunning().catch((()=>{}))}}}t.KernelManager=h},24770:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isInputReplyMsg=t.isInputRequestMsg=t.isDebugReplyMsg=t.isDebugRequestMsg=t.isExecuteReplyMsg=t.isInfoRequestMsg=t.isCommMsgMsg=t.isCommCloseMsg=t.isCommOpenMsg=t.isDebugEventMsg=t.isClearOutputMsg=t.isStatusMsg=t.isErrorMsg=t.isExecuteResultMsg=t.isExecuteInputMsg=t.isUpdateDisplayDataMsg=t.isDisplayDataMsg=t.isStreamMsg=t.createMessage=void 0;const n=s(9727);function i(e){var t,s,i,r,o;return{buffers:(t=e.buffers)!==null&&t!==void 0?t:[],channel:e.channel,content:e.content,header:{date:(new Date).toISOString(),msg_id:(s=e.msgId)!==null&&s!==void 0?s:n.UUID.uuid4(),msg_type:e.msgType,session:e.session,username:(i=e.username)!==null&&i!==void 0?i:"",version:"5.2"},metadata:(r=e.metadata)!==null&&r!==void 0?r:{},parent_header:(o=e.parentHeader)!==null&&o!==void 0?o:{}}}t.createMessage=i;function r(e){return e.header.msg_type==="stream"}t.isStreamMsg=r;function o(e){return e.header.msg_type==="display_data"}t.isDisplayDataMsg=o;function a(e){return e.header.msg_type==="update_display_data"}t.isUpdateDisplayDataMsg=a;function c(e){return e.header.msg_type==="execute_input"}t.isExecuteInputMsg=c;function l(e){return e.header.msg_type==="execute_result"}t.isExecuteResultMsg=l;function h(e){return e.header.msg_type==="error"}t.isErrorMsg=h;function u(e){return e.header.msg_type==="status"}t.isStatusMsg=u;function d(e){return e.header.msg_type==="clear_output"}t.isClearOutputMsg=d;function _(e){return e.header.msg_type==="debug_event"}t.isDebugEventMsg=_;function g(e){return e.header.msg_type==="comm_open"}t.isCommOpenMsg=g;function p(e){return e.header.msg_type==="comm_close"}t.isCommCloseMsg=p;function f(e){return e.header.msg_type==="comm_msg"}t.isCommMsgMsg=f;function m(e){return e.header.msg_type==="kernel_info_request"}t.isInfoRequestMsg=m;function v(e){return e.header.msg_type==="execute_reply"}t.isExecuteReplyMsg=v;function w(e){return e.header.msg_type==="debug_request"}t.isDebugRequestMsg=w;function S(e){return e.header.msg_type==="debug_reply"}t.isDebugReplyMsg=S;function y(e){return e.header.msg_type==="input_request"}t.isInputRequestMsg=y;function C(e){return e.header.msg_type==="input_reply"}t.isInputReplyMsg=C},43591:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getKernelModel=t.shutdownKernel=t.interruptKernel=t.restartKernel=t.startNew=t.listRunning=t.KERNEL_SERVICE_URL=void 0;const n=s(51360);const i=s(83875);const r=s(24982);t.KERNEL_SERVICE_URL="api/kernels";async function o(e=n.ServerConnection.makeSettings()){const s=i.URLExt.join(e.baseUrl,t.KERNEL_SERVICE_URL);const o=await n.ServerConnection.makeRequest(s,{},e);if(o.status!==200){const e=await n.ServerConnection.ResponseError.create(o);throw e}const a=await o.json();r.validateModels(a);return a}t.listRunning=o;async function a(e={},s=n.ServerConnection.makeSettings()){const o=i.URLExt.join(s.baseUrl,t.KERNEL_SERVICE_URL);const a={method:"POST",body:JSON.stringify(e)};const c=await n.ServerConnection.makeRequest(o,a,s);if(c.status!==201){const e=await n.ServerConnection.ResponseError.create(c);throw e}const l=await c.json();r.validateModel(l);return l}t.startNew=a;async function c(e,s=n.ServerConnection.makeSettings()){const o=i.URLExt.join(s.baseUrl,t.KERNEL_SERVICE_URL,encodeURIComponent(e),"restart");const a={method:"POST"};const c=await n.ServerConnection.makeRequest(o,a,s);if(c.status!==200){const e=await n.ServerConnection.ResponseError.create(c);throw e}const l=await c.json();r.validateModel(l)}t.restartKernel=c;async function l(e,s=n.ServerConnection.makeSettings()){const r=i.URLExt.join(s.baseUrl,t.KERNEL_SERVICE_URL,encodeURIComponent(e),"interrupt");const o={method:"POST"};const a=await n.ServerConnection.makeRequest(r,o,s);if(a.status!==204){const e=await n.ServerConnection.ResponseError.create(a);throw e}}t.interruptKernel=l;async function h(e,s=n.ServerConnection.makeSettings()){const r=i.URLExt.join(s.baseUrl,t.KERNEL_SERVICE_URL,encodeURIComponent(e));const o={method:"DELETE"};const a=await n.ServerConnection.makeRequest(r,o,s);if(a.status===404){const t=`The kernel "${e}" does not exist on the server`;console.warn(t)}else if(a.status!==204){const e=await n.ServerConnection.ResponseError.create(a);throw e}}t.shutdownKernel=h;async function u(e,s=n.ServerConnection.makeSettings()){const o=i.URLExt.join(s.baseUrl,t.KERNEL_SERVICE_URL,encodeURIComponent(e));const a=await n.ServerConnection.makeRequest(o,{},s);if(a.status===404){return undefined}else if(a.status!==200){const e=await n.ServerConnection.ResponseError.create(a);throw e}const c=await a.json();r.validateModel(c);return c}t.getKernelModel=u},49211:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.serialize=t.deserialize=void 0;function s(e){let t;if(typeof e==="string"){t=JSON.parse(e)}else{t=i(e)}return t}t.deserialize=s;function n(e){var t;let s;if((t=e.buffers)===null||t===void 0?void 0:t.length){s=r(e)}else{s=JSON.stringify(e)}return s}t.serialize=n;function i(e){const t=new DataView(e);const s=t.getUint32(0);const n=[];if(s<2){throw new Error("Invalid incoming Kernel Message")}for(let o=1;o<=s;o++){n.push(t.getUint32(o*4))}const i=new Uint8Array(e.slice(n[0],n[1]));const r=JSON.parse(new TextDecoder("utf8").decode(i));r.buffers=[];for(let o=1;o<s;o++){const t=n[o];const s=n[o+1]||e.byteLength;r.buffers.push(new DataView(e.slice(t,s)))}return r}function r(e){const t=[];const s=[];const n=new TextEncoder;let i=[];if(e.buffers!==undefined){i=e.buffers;delete e["buffers"]}const r=n.encode(JSON.stringify(e));s.push(r.buffer);for(let l=0;l<i.length;l++){const e=i[l];s.push(ArrayBuffer.isView(e)?e.buffer:e)}const o=s.length;t.push(4*(o+1));for(let l=0;l+1<s.length;l++){t.push(t[t.length-1]+s[l].byteLength)}const a=new Uint8Array(t[t.length-1]+s[s.length-1].byteLength);const c=new DataView(a.buffer);c.setUint32(0,o);for(let l=0;l<t.length;l++){c.setUint32(4*(l+1),t[l])}for(let l=0;l<s.length;l++){a.set(new Uint8Array(s[l]),t[l])}return a.buffer}},24982:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateModels=t.validateModel=t.validateMessage=void 0;const n=s(79612);const i=["username","version","session","msg_id","msg_type"];const r={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function o(e){for(let t=0;t<i.length;t++){n.validateProperty(e,i[t],"string")}}function a(e){n.validateProperty(e,"metadata","object");n.validateProperty(e,"content","object");n.validateProperty(e,"channel","string");o(e.header);if(e.channel==="iopub"){c(e)}}t.validateMessage=a;function c(e){if(e.channel==="iopub"){const t=r[e.header.msg_type];if(t===undefined){return}const s=Object.keys(t);const i=e.content;for(let e=0;e<s.length;e++){let r=t[s[e]];if(!Array.isArray(r)){r=[r]}n.validateProperty(i,s[e],...r)}}}function l(e){n.validateProperty(e,"name","string");n.validateProperty(e,"id","string")}t.validateModel=l;function h(e){if(!Array.isArray(e)){throw new Error("Invalid kernel list")}e.forEach((e=>l(e)))}t.validateModels=h},2384:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))n(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});t.KernelSpecAPI=t.KernelSpec=void 0;const a=r(s(16753));t.KernelSpec=a;const c=r(s(32391));t.KernelSpecAPI=c;o(s(95262),t)},16753:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true})},95262:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.KernelSpecManager=void 0;const o=s(9727);const a=s(87598);const c=s(75138);const l=r(s(32391));const h=s(93773);class u extends h.BaseManager{constructor(e={}){var t;super(e);this._isReady=false;this._connectionFailure=new c.Signal(this);this._specs=null;this._specsChanged=new c.Signal(this);this._ready=Promise.all([this.requestSpecs()]).then((e=>undefined)).catch((e=>undefined)).then((()=>{if(this.isDisposed){return}this._isReady=true}));this._pollSpecs=new a.Poll({auto:false,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:true,max:300*1e3},name:`@jupyterlab/services:KernelSpecManager#specs`,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"});void this.ready.then((()=>{void this._pollSpecs.start()}))}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose();super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh();await this._pollSpecs.tick}async requestSpecs(){const e=await l.getSpecs(this.serverSettings);if(this.isDisposed){return}if(!o.JSONExt.deepEqual(e,this._specs)){this._specs=e;this._specsChanged.emit(e)}}}t.KernelSpecManager=u},32391:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getSpecs=void 0;const n=s(51360);const i=s(61711);const r=s(83875);const o="api/kernelspecs";async function a(e=n.ServerConnection.makeSettings()){const t=r.URLExt.join(e.baseUrl,o);const s=await n.ServerConnection.makeRequest(t,{},e);if(s.status!==200){const e=await n.ServerConnection.ResponseError.create(s);throw e}const a=await s.json();return i.validateSpecModels(a)}t.getSpecs=a},61711:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateSpecModels=t.validateSpecModel=void 0;const n=s(79612);function i(e){const t=e.spec;if(!t){throw new Error("Invalid kernel spec")}n.validateProperty(e,"name","string");n.validateProperty(e,"resources","object");n.validateProperty(t,"language","string");n.validateProperty(t,"display_name","string");n.validateProperty(t,"argv","array");let s=null;if(t.hasOwnProperty("metadata")){n.validateProperty(t,"metadata","object");s=t.metadata}let i=null;if(t.hasOwnProperty("env")){n.validateProperty(t,"env","object");i=t.env}return{name:e.name,resources:e.resources,language:t.language,display_name:t.display_name,argv:t.argv,metadata:s,env:i}}t.validateSpecModel=i;function r(e){if(!e.hasOwnProperty("kernelspecs")){throw new Error("No kernelspecs found")}let t=Object.keys(e.kernelspecs);const s=Object.create(null);let n=e.default;for(let o=0;o<t.length;o++){const n=e.kernelspecs[t[o]];try{s[t[o]]=i(n)}catch(r){console.warn(`Removing errant kernel spec: ${t[o]}`)}}t=Object.keys(s);if(!t.length){throw new Error("No valid kernelspecs found")}if(!n||typeof n!=="string"||!(n in s)){n=t[0];console.warn(`Default kernel not found, using '${t[0]}'`)}return{default:n,kernelspecs:s}}t.validateSpecModels=r},85091:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ServiceManager=void 0;const n=s(75138);const i=s(77522);const r=s(98869);const o=s(64994);const a=s(2384);const c=s(47626);const l=s(32385);const h=s(97228);const u=s(51360);const d=s(73064);const _=s(10290);class g{constructor(e={}){var t,s;this._isDisposed=false;this._connectionFailure=new n.Signal(this);this._isReady=false;const g=e.defaultDrive;const p=(t=e.serverSettings)!==null&&t!==void 0?t:u.ServerConnection.makeSettings();const f=(s=e.standby)!==null&&s!==void 0?s:"when-hidden";const m={defaultDrive:g,serverSettings:p,standby:f};const v=new _.KernelManager(m);this.serverSettings=p;this.contents=new o.ContentsManager(m);this.sessions=new c.SessionManager(Object.assign(Object.assign({},m),{kernelManager:v}));this.settings=new l.SettingManager(m);this.terminals=new h.TerminalManager(m);this.builder=new i.BuildManager(m);this.workspaces=new d.WorkspaceManager(m);this.nbconvert=new r.NbConvertManager(m);this.kernelspecs=new a.KernelSpecManager(m);this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this);this.sessions.connectionFailure.connect(this._onConnectionFailure,this);this.terminals.connectionFailure.connect(this._onConnectionFailure,this);const w=[this.sessions.ready,this.kernelspecs.ready];if(this.terminals.isAvailable()){w.push(this.terminals.ready)}this._readyPromise=Promise.all(w).then((()=>{this._isReady=true}))}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){if(this.isDisposed){return}this._isDisposed=true;n.Signal.clearData(this);this.contents.dispose();this.sessions.dispose();this.terminals.dispose()}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}}t.ServiceManager=g},98869:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NbConvertManager=void 0;const n=s(83875);const i=s(51360);const r="api/nbconvert";class o{constructor(e={}){var t;this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:i.ServerConnection.makeSettings()}async getExportFormats(){const e=this.serverSettings.baseUrl;const t=n.URLExt.join(e,r);const{serverSettings:s}=this;const o=await i.ServerConnection.makeRequest(t,{},s);if(o.status!==200){const e=await i.ServerConnection.ResponseError.create(o);throw e}const a=await o.json();const c={};const l=Object.keys(a);l.forEach((function(e){const t=a[e].output_mimetype;c[e]={output_mimetype:t}}));return c}}t.NbConvertManager=o},51360:(e,t,s)=>{"use strict";var n=s(34406);var i,r,o;Object.defineProperty(t,"__esModule",{value:true});t.ServerConnection=void 0;const a=s(83875);let c;let l;let h;let u;if(typeof window==="undefined"){const e=s(86786);c=(i=s.g.fetch)!==null&&i!==void 0?i:e;h=(r=s.g.Request)!==null&&r!==void 0?r:e.Request;l=(o=s.g.Headers)!==null&&o!==void 0?o:e.Headers;u=s(22439)}else{c=fetch;h=Request;l=Headers;u=WebSocket}var d;(function(e){function t(e){return _.makeSettings(e)}e.makeSettings=t;function s(e,t,s){return _.handleRequest(e,t,s)}e.makeRequest=s;class n extends Error{constructor(e,t=`Invalid response: ${e.status} ${e.statusText}`,s=""){super(t);this.response=e;this.traceback=s}static async create(e){try{const t=await e.json();if(t["traceback"]){console.error(t["traceback"])}if(t["message"]){return new n(e,t["message"])}return new n(e)}catch(t){console.debug(t);return new n(e)}}}e.ResponseError=n;class i extends TypeError{constructor(e){super(e.message);this.stack=e.stack}}e.NetworkError=i})(d=t.ServerConnection||(t.ServerConnection={}));var _;(function(e){function t(e={}){const t=a.PageConfig.getBaseUrl();const s=a.PageConfig.getWsUrl();const i=a.URLExt.normalize(e.baseUrl)||t;let r=e.wsUrl;if(!r&&i===t){r=s}if(!r&&i.indexOf("http")===0){r="ws"+i.slice(4)}r=r!==null&&r!==void 0?r:s;return Object.assign(Object.assign({init:{cache:"no-store",credentials:"same-origin"},fetch:c,Headers:l,Request:h,WebSocket:u,token:a.PageConfig.getToken(),appUrl:a.PageConfig.getOption("appUrl"),appendToken:typeof window==="undefined"||n.env.JEST_WORKER_ID!==undefined||a.URLExt.getHostName(t)!==a.URLExt.getHostName(r)},e),{baseUrl:i,wsUrl:r})}e.makeSettings=t;function s(e,t,s){var n;if(e.indexOf(s.baseUrl)!==0){throw new Error("Can only be used for notebook server requests")}const r=(n=t.cache)!==null&&n!==void 0?n:s.init.cache;if(r==="no-store"){e+=(/\?/.test(e)?"&":"?")+(new Date).getTime()}const o=new s.Request(e,Object.assign(Object.assign({},s.init),t));let a=false;if(s.token){a=true;o.headers.append("Authorization",`token ${s.token}`)}if(typeof document!=="undefined"&&(document===null||document===void 0?void 0:document.cookie)){const e=i("_xsrf");if(e!==undefined){a=true;o.headers.append("X-XSRFToken",e)}}if(!o.headers.has("Content-Type")&&a){o.headers.set("Content-Type","application/json")}return s.fetch.call(null,o).catch((e=>{throw new d.NetworkError(e)}))}e.handleRequest=s;function i(e){const t=document.cookie.match("\\b"+e+"=([^;]*)\\b");return t===null||t===void 0?void 0:t[1]}})(_||(_={}))},80487:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SessionConnection=void 0;const n=s(75138);const i=s(75977);const r=s(46340);const o=s(9727);class a{constructor(e){var t,s,r,a;this._id="";this._path="";this._name="";this._type="";this._kernel=null;this._isDisposed=false;this._disposed=new n.Signal(this);this._kernelChanged=new n.Signal(this);this._statusChanged=new n.Signal(this);this._connectionStatusChanged=new n.Signal(this);this._pendingInput=new n.Signal(this);this._iopubMessage=new n.Signal(this);this._unhandledMessage=new n.Signal(this);this._anyMessage=new n.Signal(this);this._propertyChanged=new n.Signal(this);this._id=e.model.id;this._name=e.model.name;this._path=e.model.path;this._type=e.model.type;this._username=(t=e.username)!==null&&t!==void 0?t:"";this._clientId=(s=e.clientId)!==null&&s!==void 0?s:o.UUID.uuid4();this._connectToKernel=e.connectToKernel;this._kernelConnectionOptions=(r=e.kernelConnectionOptions)!==null&&r!==void 0?r:{};this.serverSettings=(a=e.serverSettings)!==null&&a!==void 0?a:i.ServerConnection.makeSettings();this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get pendingInput(){return this._pendingInput}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){const t=this.model;this._path=e.path;this._name=e.name;this._type=e.type;if(this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){if(this._kernel!==null){this._kernel.dispose()}const t=this._kernel||null;this.setupKernel(e.kernel);const s=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:t,newValue:s})}this._handleModelChange(t)}dispose(){if(this.isDisposed){return}this._isDisposed=true;this._disposed.emit();if(this._kernel){this._kernel.dispose();const e=this._kernel;this._kernel=null;const t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}n.Signal.clearData(this)}async setPath(e){if(this.isDisposed){throw new Error("Session is disposed")}await this._patch({path:e})}async setName(e){if(this.isDisposed){throw new Error("Session is disposed")}await this._patch({name:e})}async setType(e){if(this.isDisposed){throw new Error("Session is disposed")}await this._patch({type:e})}async changeKernel(e){if(this.isDisposed){throw new Error("Session is disposed")}await this._patch({kernel:e});return this.kernel}async shutdown(){if(this.isDisposed){throw new Error("Session is disposed")}await r.shutdownSession(this.id,this.serverSettings);this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}const t=this._connectToKernel(Object.assign(Object.assign({},this._kernelConnectionOptions),{model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings}));this._kernel=t;t.statusChanged.connect(this.onKernelStatus,this);t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this);t.pendingInput.connect(this.onPendingInput,this);t.unhandledMessage.connect(this.onUnhandledMessage,this);t.iopubMessage.connect(this.onIOPubMessage,this);t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onPendingInput(e,t){this._pendingInput.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){const t=await r.updateSession(Object.assign(Object.assign({},e),{id:this._id}),this.serverSettings);this.update(t);return t}_handleModelChange(e){if(e.name!==this._name){this._propertyChanged.emit("name")}if(e.type!==this._type){this._propertyChanged.emit("type")}if(e.path!==this._path){this._propertyChanged.emit("path")}}}t.SessionConnection=a},47626:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))n(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});t.SessionAPI=t.Session=void 0;const a=r(s(78));t.Session=a;const c=r(s(46340));t.SessionAPI=c;o(s(65339),t)},65339:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SessionManager=void 0;const n=s(62867);const i=s(87598);const r=s(75138);const o=s(51360);const a=s(93773);const c=s(80487);const l=s(46340);class h extends a.BaseManager{constructor(e){var t;super(e);this._isReady=false;this._sessionConnections=new Set;this._models=new Map;this._runningChanged=new r.Signal(this);this._connectionFailure=new r.Signal(this);this._connectToKernel=e=>this._kernelManager.connectTo(e);this._kernelManager=e.kernelManager;this._pollModels=new i.Poll({auto:false,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:true,max:300*1e3},name:`@jupyterlab/services:SessionManager#models`,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"});this._ready=(async()=>{await this._pollModels.start();await this._pollModels.tick;await this._kernelManager.ready;this._isReady=true})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){if(this.isDisposed){return}this._models.clear();this._sessionConnections.forEach((e=>e.dispose()));this._pollModels.dispose();super.dispose()}connectTo(e){const t=new c.SessionConnection(Object.assign(Object.assign({},e),{connectToKernel:this._connectToKernel,serverSettings:this.serverSettings}));this._onStarted(t);if(!this._models.has(e.model.id)){void this.refreshRunning().catch((()=>{}))}return t}running(){return n.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh();await this._pollModels.tick}async startNew(e,t={}){const s=await l.startSession(e,this.serverSettings);await this.refreshRunning();return this.connectTo(Object.assign(Object.assign({},t),{model:s}))}async shutdown(e){await l.shutdownSession(e,this.serverSettings);await this.refreshRunning()}async shutdownAll(){await this.refreshRunning();await Promise.all([...this._models.keys()].map((e=>l.shutdownSession(e,this.serverSettings))));await this.refreshRunning()}async stopIfNeeded(e){try{const t=await l.listRunning(this.serverSettings);const s=t.filter((t=>t.path===e));if(s.length===1){const e=s[0].id;await this.shutdown(e)}}catch(t){}}async findById(e){if(this._models.has(e)){return this._models.get(e)}await this.refreshRunning();return this._models.get(e)}async findByPath(e){for(const t of this._models.values()){if(t.path===e){return t}}await this.refreshRunning();for(const t of this._models.values()){if(t.path===e){return t}}return undefined}async requestRunning(){var e,t;let s;try{s=await l.listRunning(this.serverSettings)}catch(i){if(i instanceof o.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424){this._connectionFailure.emit(i)}throw i}if(this.isDisposed){return}if(this._models.size===s.length&&n.every(s,(e=>{var t,s,n,i;const r=this._models.get(e.id);if(!r){return false}return((t=r.kernel)===null||t===void 0?void 0:t.id)===((s=e.kernel)===null||s===void 0?void 0:s.id)&&((n=r.kernel)===null||n===void 0?void 0:n.name)===((i=e.kernel)===null||i===void 0?void 0:i.name)&&r.name===e.name&&r.path===e.path&&r.type===e.type}))){return}this._models=new Map(s.map((e=>[e.id,e])));this._sessionConnections.forEach((e=>{if(this._models.has(e.id)){e.update(this._models.get(e.id))}else{e.dispose()}}));this._runningChanged.emit(s)}_onStarted(e){this._sessionConnections.add(e);e.disposed.connect(this._onDisposed,this);e.propertyChanged.connect(this._onChanged,this);e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e);void this.refreshRunning().catch((()=>{}))}_onChanged(){void this.refreshRunning().catch((()=>{}))}}t.SessionManager=h},46340:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.updateSession=t.startSession=t.getSessionModel=t.shutdownSession=t.getSessionUrl=t.listRunning=t.SESSION_SERVICE_URL=void 0;const n=s(51360);const i=s(83875);const r=s(68204);t.SESSION_SERVICE_URL="api/sessions";async function o(e=n.ServerConnection.makeSettings()){const s=i.URLExt.join(e.baseUrl,t.SESSION_SERVICE_URL);const o=await n.ServerConnection.makeRequest(s,{},e);if(o.status!==200){const e=await n.ServerConnection.ResponseError.create(o);throw e}const a=await o.json();if(!Array.isArray(a)){throw new Error("Invalid Session list")}a.forEach((e=>{r.updateLegacySessionModel(e);r.validateModel(e)}));return a}t.listRunning=o;function a(e,s){return i.URLExt.join(e,t.SESSION_SERVICE_URL,s)}t.getSessionUrl=a;async function c(e,t=n.ServerConnection.makeSettings()){var s;const i=a(t.baseUrl,e);const r={method:"DELETE"};const o=await n.ServerConnection.makeRequest(i,r,t);if(o.status===404){const t=await o.json();const n=(s=t.message)!==null&&s!==void 0?s:`The session "${e}"" does not exist on the server`;console.warn(n)}else if(o.status===410){throw new n.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not")}else if(o.status!==204){const e=await n.ServerConnection.ResponseError.create(o);throw e}}t.shutdownSession=c;async function l(e,t=n.ServerConnection.makeSettings()){const s=a(t.baseUrl,e);const i=await n.ServerConnection.makeRequest(s,{},t);if(i.status!==200){const e=await n.ServerConnection.ResponseError.create(i);throw e}const o=await i.json();r.updateLegacySessionModel(o);r.validateModel(o);return o}t.getSessionModel=l;async function h(e,s=n.ServerConnection.makeSettings()){const o=i.URLExt.join(s.baseUrl,t.SESSION_SERVICE_URL);const a={method:"POST",body:JSON.stringify(e)};const c=await n.ServerConnection.makeRequest(o,a,s);if(c.status!==201){const e=await n.ServerConnection.ResponseError.create(c);throw e}const l=await c.json();r.updateLegacySessionModel(l);r.validateModel(l);return l}t.startSession=h;async function u(e,t=n.ServerConnection.makeSettings()){const s=a(t.baseUrl,e.id);const i={method:"PATCH",body:JSON.stringify(e)};const o=await n.ServerConnection.makeRequest(s,i,t);if(o.status!==200){const e=await n.ServerConnection.ResponseError.create(o);throw e}const c=await o.json();r.updateLegacySessionModel(c);r.validateModel(c);return c}t.updateSession=u},78:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true})},68204:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateModels=t.updateLegacySessionModel=t.validateModel=void 0;const n=s(24982);const i=s(79612);function r(e){i.validateProperty(e,"id","string");i.validateProperty(e,"type","string");i.validateProperty(e,"name","string");i.validateProperty(e,"path","string");i.validateProperty(e,"kernel","object");n.validateModel(e.kernel)}t.validateModel=r;function o(e){if(e.path===undefined&&e.notebook!==undefined){e.path=e.notebook.path;e.type="notebook";e.name=""}}t.updateLegacySessionModel=o;function a(e){if(!Array.isArray(e)){throw new Error("Invalid session list")}e.forEach((e=>r(e)))}t.validateModels=a},32385:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SettingManager=void 0;const n=s(83875);const i=s(53371);const r=s(51360);const o="api/settings";class a extends i.DataConnector{constructor(e={}){var t;super();this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:r.ServerConnection.makeSettings()}async fetch(e){if(!e){throw new Error("Plugin `id` parameter is required for settings fetch.")}const{serverSettings:t}=this;const{baseUrl:s,appUrl:n}=t;const{makeRequest:i,ResponseError:o}=r.ServerConnection;const a=s+n;const l=c.url(a,e);const h=await i(l,{},t);if(h.status!==200){const e=await o.create(h);throw e}return h.json()}async list(){var e,t;const{serverSettings:s}=this;const{baseUrl:n,appUrl:i}=s;const{makeRequest:o,ResponseError:a}=r.ServerConnection;const l=n+i;const h=c.url(l,"");const u=await o(h,{},s);if(u.status!==200){throw new a(u)}const d=await u.json();const _=(t=(e=d===null||d===void 0?void 0:d["settings"])===null||e===void 0?void 0:e.map((e=>{e.data={composite:{},user:{}};return e})))!==null&&t!==void 0?t:[];const g=_.map((e=>e.id));return{ids:g,values:_}}async save(e,t){const{serverSettings:s}=this;const{baseUrl:n,appUrl:i}=s;const{makeRequest:o,ResponseError:a}=r.ServerConnection;const l=n+i;const h=c.url(l,e);const u={body:JSON.stringify({raw:t}),method:"PUT"};const d=await o(h,u,s);if(d.status!==204){throw new a(d)}}}t.SettingManager=a;var c;(function(e){function t(e,t){return n.URLExt.join(e,o,t)}e.url=t})(c||(c={}))},1497:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TerminalConnection=void 0;const n=s(83875);const i=s(9727);const r=s(75138);const o=s(75977);const a=s(35681);class c{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed();this._clearSocket();this._updateConnectionStatus("connecting");const e=this._name;const t=this.serverSettings;let s=n.URLExt.join(t.wsUrl,"terminals","websocket",encodeURIComponent(e));const i=t.token;if(t.appendToken&&i!==""){s=s+`?token=${encodeURIComponent(i)}`}this._ws=new t.WebSocket(s);this._ws.onmessage=this._onWSMessage;this._ws.onclose=this._onWSClose;this._ws.onerror=this._onWSClose};this._onWSMessage=e=>{if(this._isDisposed){return}const t=JSON.parse(e.data);if(t[0]==="disconnect"){this.dispose()}if(this._connectionStatus==="connecting"){if(t[0]==="setup"){this._updateConnectionStatus("connected")}return}this._messageReceived.emit({type:t[0],content:t.slice(1)})};this._onWSClose=e=>{console.warn(`Terminal websocket closed: ${e.code}`);if(!this.isDisposed){this._reconnect()}};this._connectionStatus="connecting";this._connectionStatusChanged=new r.Signal(this);this._isDisposed=false;this._disposed=new r.Signal(this);this._messageReceived=new r.Signal(this);this._reconnectTimeout=null;this._ws=null;this._noOp=()=>{};this._reconnectLimit=7;this._reconnectAttempt=0;this._pendingMessages=[];this._name=e.model.name;this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:o.ServerConnection.makeSettings();this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){if(this._isDisposed){return}this._isDisposed=true;this._disposed.emit();this._updateConnectionStatus("disconnected");this._clearSocket();r.Signal.clearData(this)}send(e){this._sendMessage(e)}_sendMessage(e,t=true){if(this._isDisposed||!e.content){return}if(this.connectionStatus==="connected"&&this._ws){const t=[e.type,...e.content];this._ws.send(JSON.stringify(t))}else if(t){this._pendingMessages.push(e)}else{throw new Error(`Could not send message: ${JSON.stringify(e)}`)}}_sendPending(){while(this.connectionStatus==="connected"&&this._pendingMessages.length>0){this._sendMessage(this._pendingMessages[0],false);this._pendingMessages.shift()}}reconnect(){this._errorIfDisposed();const e=new i.PromiseDelegate;const t=(s,n)=>{if(n==="connected"){e.resolve();this.connectionStatusChanged.disconnect(t,this)}else if(n==="disconnected"){e.reject(new Error("Terminal connection disconnected"));this.connectionStatusChanged.disconnect(t,this)}};this.connectionStatusChanged.connect(t,this);this._reconnectAttempt=0;this._reconnect();return e.promise}_reconnect(){this._errorIfDisposed();clearTimeout(this._reconnectTimeout);if(this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");const e=l.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`);this._reconnectTimeout=setTimeout(this._createSocket,e);this._reconnectAttempt+=1}else{this._updateConnectionStatus("disconnected")}this._clearSocket()}_clearSocket(){if(this._ws!==null){this._ws.onopen=this._noOp;this._ws.onclose=this._noOp;this._ws.onerror=this._noOp;this._ws.onmessage=this._noOp;this._ws.close();this._ws=null}}async shutdown(){await a.shutdownTerminal(this.name,this.serverSettings);this.dispose()}clone(){return new c(this)}_updateConnectionStatus(e){if(this._connectionStatus===e){return}this._connectionStatus=e;if(e!=="connecting"){this._reconnectAttempt=0;clearTimeout(this._reconnectTimeout)}if(e==="connected"){this._sendPending()}this._connectionStatusChanged.emit(e)}_errorIfDisposed(){if(this.isDisposed){throw new Error("Terminal connection is disposed")}}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}}t.TerminalConnection=c;var l;(function(e){function t(e,t){return n.URLExt.join(e,a.TERMINAL_SERVICE_URL,encodeURIComponent(t))}e.getTermUrl=t;function s(e,t){e=Math.ceil(e);t=Math.floor(t);return Math.floor(Math.random()*(t-e+1))+e}e.getRandomIntInclusive=s})(l||(l={}))},97228:function(e,t,s){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){if(n===undefined)n=s;Object.defineProperty(e,n,{enumerable:true,get:function(){return t[s]}})}:function(e,t,s,n){if(n===undefined)n=s;e[n]=t[s]});var i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)if(s!=="default"&&Object.prototype.hasOwnProperty.call(e,s))n(t,e,s);i(t,e);return t};var o=this&&this.__exportStar||function(e,t){for(var s in e)if(s!=="default"&&!Object.prototype.hasOwnProperty.call(t,s))n(t,e,s)};Object.defineProperty(t,"__esModule",{value:true});t.TerminalAPI=t.Terminal=void 0;const a=r(s(68993));t.Terminal=a;const c=r(s(35681));t.TerminalAPI=c;o(s(76663),t)},76663:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TerminalManager=void 0;const n=s(62867);const i=s(87598);const r=s(75138);const o=s(75977);const a=s(93773);const c=s(35681);const l=s(1497);class h extends a.BaseManager{constructor(e={}){var t;super(e);this._isReady=false;this._names=[];this._terminalConnections=new Set;this._runningChanged=new r.Signal(this);this._connectionFailure=new r.Signal(this);if(!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable");this._ready.catch((e=>undefined));return}this._pollModels=new i.Poll({auto:false,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:true,max:300*1e3},name:`@jupyterlab/services:TerminalManager#models`,standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"});this._ready=(async()=>{await this._pollModels.start();await this._pollModels.tick;this._isReady=true})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){if(this.isDisposed){return}this._names.length=0;this._terminalConnections.forEach((e=>e.dispose()));this._pollModels.dispose();super.dispose()}isAvailable(){return c.isAvailable()}connectTo(e){const t=new l.TerminalConnection(Object.assign(Object.assign({},e),{serverSettings:this.serverSettings}));this._onStarted(t);if(!this._names.includes(e.model.name)){void this.refreshRunning().catch((()=>{}))}return t}running(){return n.iter(this._models)}async refreshRunning(){await this._pollModels.refresh();await this._pollModels.tick}async startNew(){const e=await c.startNew(this.serverSettings);await this.refreshRunning();return this.connectTo({model:e})}async shutdown(e){await c.shutdownTerminal(e,this.serverSettings);await this.refreshRunning()}async shutdownAll(){await this.refreshRunning();await Promise.all(this._names.map((e=>c.shutdownTerminal(e,this.serverSettings))));await this.refreshRunning()}async requestRunning(){var e,t;let s;try{s=await c.listRunning(this.serverSettings)}catch(i){if(i instanceof o.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424){this._connectionFailure.emit(i)}throw i}if(this.isDisposed){return}const n=s.map((({name:e})=>e)).sort();if(n===this._names){return}this._names=n;this._terminalConnections.forEach((e=>{if(!n.includes(e.name)){e.dispose()}}));this._runningChanged.emit(this._models)}_onStarted(e){this._terminalConnections.add(e);e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e);void this.refreshRunning().catch((()=>{}))}get _models(){return this._names.map((e=>({name:e})))}}t.TerminalManager=h},35681:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.shutdownTerminal=t.listRunning=t.startNew=t.isAvailable=t.TERMINAL_SERVICE_URL=void 0;const n=s(83875);const i=s(51360);t.TERMINAL_SERVICE_URL="api/terminals";function r(){const e=String(n.PageConfig.getOption("terminalsAvailable"));return e.toLowerCase()==="true"}t.isAvailable=r;async function o(e=i.ServerConnection.makeSettings()){l.errorIfNotAvailable();const s=n.URLExt.join(e.baseUrl,t.TERMINAL_SERVICE_URL);const r={method:"POST"};const o=await i.ServerConnection.makeRequest(s,r,e);if(o.status!==200){const e=await i.ServerConnection.ResponseError.create(o);throw e}const a=await o.json();return a}t.startNew=o;async function a(e=i.ServerConnection.makeSettings()){l.errorIfNotAvailable();const s=n.URLExt.join(e.baseUrl,t.TERMINAL_SERVICE_URL);const r=await i.ServerConnection.makeRequest(s,{},e);if(r.status!==200){const e=await i.ServerConnection.ResponseError.create(r);throw e}const o=await r.json();if(!Array.isArray(o)){throw new Error("Invalid terminal list")}return o}t.listRunning=a;async function c(e,s=i.ServerConnection.makeSettings()){var r;l.errorIfNotAvailable();const o=n.URLExt.join(s.baseUrl,t.TERMINAL_SERVICE_URL,e);const a={method:"DELETE"};const c=await i.ServerConnection.makeRequest(o,a,s);if(c.status===404){const t=await c.json();const s=(r=t.message)!==null&&r!==void 0?r:`The terminal session "${e}"" does not exist on the server`;console.warn(s)}else if(c.status!==204){const e=await i.ServerConnection.ResponseError.create(c);throw e}}t.shutdownTerminal=c;var l;(function(e){function t(){if(!r()){throw new Error("Terminals Unavailable")}}e.errorIfNotAvailable=t})(l||(l={}))},68993:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isAvailable=void 0;const n=s(35681);Object.defineProperty(t,"isAvailable",{enumerable:true,get:function(){return n.isAvailable}})},79612:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateProperty=void 0;function s(e,t,s,n=[]){if(!e.hasOwnProperty(t)){throw Error(`Missing property '${t}'`)}const i=e[t];if(s!==void 0){let e=true;switch(s){case"array":e=Array.isArray(i);break;case"object":e=typeof i!=="undefined";break;default:e=typeof i===s}if(!e){throw new Error(`Property '${t}' is not of type '${s}'`)}if(n.length>0){let e=true;switch(s){case"string":case"number":case"boolean":e=n.includes(i);break;default:e=n.findIndex((e=>e===i))>=0;break}if(!e){throw new Error(`Property '${t}' is not one of the valid values ${JSON.stringify(n)}`)}}}}t.validateProperty=s},73064:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.WorkspaceManager=void 0;const n=s(83875);const i=s(53371);const r=s(51360);const o="api/workspaces";class a extends i.DataConnector{constructor(e={}){var t;super();this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:r.ServerConnection.makeSettings()}async fetch(e){const{serverSettings:t}=this;const{baseUrl:s,appUrl:n}=t;const{makeRequest:i,ResponseError:o}=r.ServerConnection;const a=s+n;const l=c.url(a,e);const h=await i(l,{},t);if(h.status!==200){const e=await o.create(h);throw e}return h.json()}async list(){const{serverSettings:e}=this;const{baseUrl:t,appUrl:s}=e;const{makeRequest:n,ResponseError:i}=r.ServerConnection;const o=t+s;const a=c.url(o,"");const l=await n(a,{},e);if(l.status!==200){const e=await i.create(l);throw e}const h=await l.json();return h.workspaces}async remove(e){const{serverSettings:t}=this;const{baseUrl:s,appUrl:n}=t;const{makeRequest:i,ResponseError:o}=r.ServerConnection;const a=s+n;const l=c.url(a,e);const h={method:"DELETE"};const u=await i(l,h,t);if(u.status!==204){const e=await o.create(u);throw e}}async save(e,t){const{serverSettings:s}=this;const{baseUrl:n,appUrl:i}=s;const{makeRequest:o,ResponseError:a}=r.ServerConnection;const l=n+i;const h=c.url(l,e);const u={body:JSON.stringify(t),method:"PUT"};const d=await o(h,u,s);if(d.status!==204){const e=await a.create(d);throw e}}}t.WorkspaceManager=a;var c;(function(e){function t(e,t){return n.URLExt.join(e,o,t)}e.url=t})(c||(c={}))}}]);