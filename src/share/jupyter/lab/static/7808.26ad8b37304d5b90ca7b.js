(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[7808],{17808:(e,t,n)=>{"use strict";n.r(t);n.d(t,{savingStatusPlugin:()=>S,pathStatusPlugin:()=>I,downloadPlugin:()=>A,openBrowserTabPlugin:()=>B,default:()=>E});var o=n(20650);var a=n.n(o);var r=n(26825);var i=n.n(r);var s=n(83875);var c=n.n(s);var d=n(54005);var l=n.n(d);var u=n(59917);var m=n.n(u);var g=n(68992);var p=n.n(g);var f=n(10314);var v=n.n(f);var h=n(1612);var _=n.n(h);var w=n(62867);var b=n.n(w);var y=n(9727);var x=n.n(y);var C=n(61389);var D=n.n(C);var W;(function(e){e.clone="docmanager:clone";e.deleteFile="docmanager:delete-file";e.newUntitled="docmanager:new-untitled";e.open="docmanager:open";e.openBrowserTab="docmanager:open-browser-tab";e.reload="docmanager:reload";e.rename="docmanager:rename";e.del="docmanager:delete";e.restoreCheckpoint="docmanager:restore-checkpoint";e.save="docmanager:save";e.saveAll="docmanager:save-all";e.saveAs="docmanager:save-as";e.download="docmanager:download";e.toggleAutosave="docmanager:toggle-autosave";e.showInFileBrowser="docmanager:show-in-file-browser"})(W||(W={}));const k="@jupyterlab/docmanager-extension:plugin";const F={id:k,provides:d.IDocumentManager,requires:[g.ISettingRegistry,h.ITranslator],optional:[o.ILabStatus,r.ICommandPalette,o.ILabShell,r.ISessionContextDialogs,u.IDocumentProviderFactory],activate:(e,t,n,o,a,r,i,s)=>{var c;const l=n.load("jupyterlab");const u=e.serviceManager;const m=new WeakSet;const g={open:(t,n)=>{if(!t.id){t.id=`document-manager-${++P.id}`}t.title.dataset=Object.assign({type:"document-title"},t.title.dataset);if(!t.isAttached){e.shell.add(t,"main",n||{})}e.shell.activateById(t.id);const a=v.contextForWidget(t);if(a&&!m.has(a)){if(o){N(o,a)}m.add(a)}}};const p=e.docRegistry;const f=e.restored.then((()=>void 0));const v=new d.DocumentManager({registry:p,manager:u,opener:g,when:f,setBusy:(c=o&&(()=>o.setBusy()))!==null&&c!==void 0?c:undefined,sessionDialogs:i||undefined,translator:n,collaborative:true,docProviderFactory:s!==null&&s!==void 0?s:undefined});j(e,v,g,t,n,r,a);const h=t=>{const n=t.get("autosave").composite;v.autosave=n===true||n===false?n:true;e.commands.notifyCommandChanged(W.toggleAutosave);const o=t.get("autosaveInterval").composite;v.autosaveInterval=o||120;const a=t.get("lastModifiedCheckMargin").composite;v.lastModifiedCheckMargin=a||500;const r=t.get("defaultViewers").composite;const i={};Object.keys(r).forEach((e=>{if(!p.getFileType(e)){console.warn(`File Type ${e} not found`);return}if(!p.getWidgetFactory(r[e])){console.warn(`Document viewer ${r[e]} not found`)}i[e]=r[e]}));(0,w.each)(p.fileTypes(),(e=>{try{p.setDefaultWidgetFactory(e.name,i[e.name])}catch(c){console.warn(`Failed to set default viewer ${i[e.name]} for file type ${e.name}`)}}))};Promise.all([t.load(k),e.restored]).then((([e])=>{e.changed.connect(h);h(e)})).catch((e=>{console.error(e.message)}));t.transform(k,{fetch:e=>{const t=(0,w.toArray)(p.fileTypes()).map((e=>e.name)).join("    \n");const n=(0,w.toArray)(p.widgetFactories()).map((e=>e.name)).join("    \n");const o=l.__(`Overrides for the default viewers for file types.\nSpecify a mapping from file type name to document viewer name, for example:\n\ndefaultViewers: {\n  markdown: "Markdown Preview"\n}\n\nIf you specify non-existent file types or viewers, or if a viewer cannot\nopen a given file type, the override will not function.\n\nAvailable viewers:\n%1\n\nAvailable file types:\n%2`,n,t);const a=y.JSONExt.deepCopy(e.schema);a.properties.defaultViewers.description=o;return Object.assign(Object.assign({},e),{schema:a})}});p.changed.connect((()=>t.reload(k)));return v}};const S={id:"@jupyterlab/docmanager-extension:saving-status",autoStart:true,requires:[d.IDocumentManager,o.ILabShell,h.ITranslator],optional:[f.IStatusBar],activate:(e,t,n,o,a)=>{if(!a){return}const r=new d.SavingStatus({docManager:t,translator:o});r.model.widget=n.currentWidget;n.currentChanged.connect((()=>{r.model.widget=n.currentWidget}));a.registerStatusItem(S.id,{item:r,align:"middle",isActive:()=>r.model!==null&&r.model.status!==null,activeStateChanged:r.model.stateChanged})}};const I={id:"@jupyterlab/docmanager-extension:path-status",autoStart:true,requires:[d.IDocumentManager,o.ILabShell],optional:[f.IStatusBar],activate:(e,t,n,o)=>{if(!o){return}const a=new d.PathStatus({docManager:t});a.model.widget=n.currentWidget;n.currentChanged.connect((()=>{a.model.widget=n.currentWidget}));o.registerStatusItem(I.id,{item:a,align:"right",rank:0})}};const A={id:"@jupyterlab/docmanager-extension:download",autoStart:true,requires:[h.ITranslator,d.IDocumentManager],optional:[r.ICommandPalette],activate:(e,t,n,o)=>{const a=t.load("jupyterlab");const{commands:i,shell:s}=e;const c=()=>{const{currentWidget:e}=s;return!!(e&&n.contextForWidget(e))};i.addCommand(W.download,{label:a.__("Download"),caption:a.__("Download the file to your computer"),isEnabled:c,execute:()=>{if(c()){const e=n.contextForWidget(s.currentWidget);if(!e){return(0,r.showDialog)({title:a.__("Cannot Download"),body:a.__("No context found for current widget!"),buttons:[r.Dialog.okButton({label:a.__("OK")})]})}return e.download()}}});const d=a.__("File Operations");if(o){o.addItem({command:W.download,category:d})}}};const B={id:"@jupyterlab/docmanager-extension:open-browser-tab",autoStart:true,requires:[h.ITranslator,d.IDocumentManager],activate:(e,t,n)=>{const o=t.load("jupyterlab");const{commands:a}=e;a.addCommand(W.openBrowserTab,{execute:e=>{const t=typeof e["path"]==="undefined"?"":e["path"];if(!t){return}return n.services.contents.getDownloadUrl(t).then((e=>{const t=window.open();if(t){t.opener=null;t.location.href=e}else{throw new Error("Failed to open new browser tab.")}}))},icon:e=>e["icon"]||"",label:()=>o.__("Open in New Browser Tab")})}};const M=[F,I,S,A,B];const E=M;class T extends C.Widget{constructor(e,t,n="notebook"){super({node:P.createRevertConfirmNode(e,n,t)})}}function O(e,t){if(!e){return"File"}const n=t.contextForWidget(e);if(!n){return""}const o=t.registry.getFileTypesForPath(n.path);return o.length&&o[0].displayName?o[0].displayName:"File"}function j(e,t,n,o,a,i,s){const c=a.load("jupyterlab");const{commands:d,shell:l}=e;const u=c.__("File Operations");const m=()=>{const{currentWidget:e}=l;return!!(e&&t.contextForWidget(e))};const g=()=>{const{currentWidget:e}=l;if(!e){return false}const n=t.contextForWidget(e);return!!(n&&n.contentsModel&&n.contentsModel.writable)};if(i){R(e,t,i,n,a)}d.addCommand(W.deleteFile,{label:()=>`Delete ${O(l.currentWidget,t)}`,execute:e=>{const n=typeof e["path"]==="undefined"?"":e["path"];if(!n){const e=W.deleteFile;throw new Error(`A non-empty path is required for ${e}.`)}return t.deleteFile(n)}});d.addCommand(W.newUntitled,{execute:e=>{const n=e["error"]||c.__("Error");const o=typeof e["path"]==="undefined"?"":e["path"];const a={type:e["type"],path:o};if(e["type"]==="file"){a.ext=e["ext"]||".txt"}return t.services.contents.newUntitled(a).catch((e=>(0,r.showErrorMessage)(n,e)))},label:e=>e["label"]||`New ${e["type"]}`});d.addCommand(W.open,{execute:e=>{const n=typeof e["path"]==="undefined"?"":e["path"];const o=e["factory"]||void 0;const a=e===null||e===void 0?void 0:e.kernel;const r=e["options"]||void 0;return t.services.contents.get(n,{content:false}).then((()=>t.openOrReveal(n,o,a,r)))},icon:e=>e["icon"]||"",label:e=>e["label"]||e["factory"],mnemonic:e=>e["mnemonic"]||-1});d.addCommand(W.reload,{label:()=>c.__("Reload %1 from Disk",O(l.currentWidget,t)),caption:c.__("Reload contents from disk"),isEnabled:m,execute:()=>{if(!m()){return}const e=t.contextForWidget(l.currentWidget);const n=O(l.currentWidget,t);if(!e){return(0,r.showDialog)({title:c.__("Cannot Reload"),body:c.__("No context found for current widget!"),buttons:[r.Dialog.okButton({label:c.__("Ok")})]})}if(e.model.dirty){return(0,r.showDialog)({title:c.__("Reload %1 from Disk",n),body:c.__("Are you sure you want to reload the %1 from the disk?",n),buttons:[r.Dialog.cancelButton({label:c.__("Cancel")}),r.Dialog.warnButton({label:c.__("Reload")})]}).then((t=>{if(t.button.accept&&!e.isDisposed){return e.revert()}}))}else{if(!e.isDisposed){return e.revert()}}}});d.addCommand(W.restoreCheckpoint,{label:()=>c.__("Revert %1 to Checkpoint",O(l.currentWidget,t)),caption:c.__("Revert contents to previous checkpoint"),isEnabled:m,execute:()=>{if(!m()){return}const e=t.contextForWidget(l.currentWidget);if(!e){return(0,r.showDialog)({title:c.__("Cannot Revert"),body:c.__("No context found for current widget!"),buttons:[r.Dialog.okButton({label:c.__("Ok")})]})}return e.listCheckpoints().then((n=>{if(n.length<1){return}const o=n[n.length-1];if(!o){return}const a=O(l.currentWidget,t);return(0,r.showDialog)({title:c.__("Revert %1 to checkpoint",a),body:new T(o,c,a),buttons:[r.Dialog.cancelButton({label:c.__("Cancel")}),r.Dialog.warnButton({label:c.__("Revert")})]}).then((t=>{if(e.isDisposed){return}if(t.button.accept){if(e.model.readOnly){return e.revert()}return e.restoreCheckpoint().then((()=>e.revert()))}}))}))}});d.addCommand(W.save,{label:()=>c.__("Save %1",O(l.currentWidget,t)),caption:c.__("Save and create checkpoint"),isEnabled:g,execute:()=>{if(m()){const e=t.contextForWidget(l.currentWidget);if(!e){return(0,r.showDialog)({title:c.__("Cannot Save"),body:c.__("No context found for current widget!"),buttons:[r.Dialog.okButton({label:c.__("Ok")})]})}else{if(e.model.readOnly){return(0,r.showDialog)({title:c.__("Cannot Save"),body:c.__("Document is read-only"),buttons:[r.Dialog.okButton({label:c.__("Ok")})]})}return e.save().then((()=>e.createCheckpoint())).catch((e=>{if(e.message==="Cancel"){return}throw e}))}}}});d.addCommand(W.saveAll,{label:()=>c.__("Save All"),caption:c.__("Save all open documents"),isEnabled:()=>(0,w.some)((0,w.map)(l.widgets("main"),(e=>t.contextForWidget(e))),(e=>{var t,n;return(n=(t=e===null||e===void 0?void 0:e.contentsModel)===null||t===void 0?void 0:t.writable)!==null&&n!==void 0?n:false})),execute:()=>{const e=[];const n=new Set;(0,w.each)(l.widgets("main"),(o=>{const a=t.contextForWidget(o);if(a&&!a.model.readOnly&&!n.has(a.path)){n.add(a.path);e.push(a.save())}}));return Promise.all(e)}});d.addCommand(W.saveAs,{label:()=>c.__("Save %1 As…",O(l.currentWidget,t)),caption:c.__("Save with new path"),isEnabled:m,execute:()=>{if(m()){const e=t.contextForWidget(l.currentWidget);if(!e){return(0,r.showDialog)({title:c.__("Cannot Save"),body:c.__("No context found for current widget!"),buttons:[r.Dialog.okButton({label:c.__("Ok")})]})}return e.saveAs()}}});d.addCommand(W.toggleAutosave,{label:c.__("Autosave Documents"),isToggled:()=>t.autosave,execute:()=>{const e=!t.autosave;const n="autosave";return o.set(k,n,e).catch((e=>{console.error(`Failed to set ${k}:${n} - ${e.message}`)}))}});if(s){[W.reload,W.restoreCheckpoint,W.save,W.saveAs,W.toggleAutosave].forEach((e=>{s.addItem({command:e,category:u})}))}}function R(e,t,n,o,a){const i=a.load("jupyterlab");const{commands:s}=e;const c=()=>{var o;const a=/[Pp]ath:\s?(.*)\n?/;const r=e=>{var t;return!!((t=e["title"])===null||t===void 0?void 0:t.match(a))};const i=e.contextMenuHitTest(r);const s=i===null||i===void 0?void 0:i["title"].match(a);return(o=s&&t.findWidget(s[1],null))!==null&&o!==void 0?o:n.currentWidget};const l=()=>{const{currentWidget:e}=n;return!!(e&&t.contextForWidget(e))};s.addCommand(W.clone,{label:()=>i.__("New View for %1",O(c(),t)),isEnabled:l,execute:e=>{const n=c();const a=e["options"]||{mode:"split-right"};if(!n){return}const r=t.cloneWidget(n);if(r){o.open(r,a)}}});s.addCommand(W.rename,{label:()=>{let e=O(c(),t);if(e){e=" "+e}return i.__("Rename%1…",e)},isEnabled:l,execute:()=>{if(l()){const e=t.contextForWidget(c());return(0,d.renameDialog)(t,e.path)}}});s.addCommand(W.del,{label:()=>i.__("Delete %1",O(c(),t)),isEnabled:l,execute:async()=>{if(l()){const n=t.contextForWidget(c());if(!n){return}const o=await(0,r.showDialog)({title:i.__("Delete"),body:i.__("Are you sure you want to delete %1",n.path),buttons:[r.Dialog.cancelButton({label:i.__("Cancel")}),r.Dialog.warnButton({label:i.__("Delete")})]});if(o.button.accept){await e.commands.execute("docmanager:delete-file",{path:n.path})}}}});s.addCommand(W.showInFileBrowser,{label:()=>i.__("Show in File Browser"),isEnabled:l,execute:async()=>{const e=c();const n=e&&t.contextForWidget(e);if(!n){return}await s.execute("filebrowser:activate",{path:n.path});await s.execute("filebrowser:go-to-path",{path:n.path})}})}function N(e,t){let n=null;const o=(t,o)=>{if(o.name==="dirty"){if(o.newValue===true){if(!n){n=e.setDirty()}}else if(n){n.dispose();n=null}}};void t.ready.then((()=>{t.model.stateChanged.connect(o);if(t.model.dirty){n=e.setDirty()}}));t.disposed.connect((()=>{if(n){n.dispose()}}))}var P;(function(e){e.id=0;function t(e,t,n){const o=document.createElement("div");const a=document.createElement("p");const r=document.createTextNode(n.__("Are you sure you want to revert the %1 to the latest checkpoint? ",t));const i=document.createElement("strong");i.textContent=n.__("This cannot be undone.");a.appendChild(r);a.appendChild(i);const c=document.createElement("p");const d=document.createTextNode(n.__("The checkpoint was last updated at: "));const l=document.createElement("p");const u=new Date(e.last_modified);l.style.textAlign="center";l.textContent=s.Time.format(u,"dddd, MMMM Do YYYY, h:mm:ss a")+" ("+s.Time.formatHuman(u)+")";c.appendChild(d);c.appendChild(l);o.appendChild(a);o.appendChild(c);return o}e.createRevertConfirmNode=t})(P||(P={}))}}]);